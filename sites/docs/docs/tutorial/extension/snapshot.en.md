---
nav: Guide
group:
  title: Plug-in functionality
  order: 3
title: Snapshot
order:  6
toc: content
tag: Optimization
---

We often need to export the canvas content as an image. We provide an independent plug-in package `Snapshot` to use this function.

## Demonstration

<code id="react-portal" src="@/src/tutorial/extension/snapshot"></code>

## usage

### 1. register

There are two registration methods, global registration and local registration. The difference is that global registration is available for every `lf` instance.

```tsx | pure
import LogicFlow from "@logicflow/core";
import { Snapshot } from "@logicflow/extension";

// Global Registration
LogicFlow.use(Snapshot);

// Partial Registration
const lf = new LogicFlow({
  ...config,
  plugins: [Snapshot]
});

```

### 2. use

After registration, the `getSnapshot()` method will be mounted on the `lf` instance and called through the `lf.getSnapshot()` method.

```tsx | pure

// Can be triggered in any way, and then the drawn graphics are downloaded to the local disk
document.getElementById("button").addEventListener("click", () => {
  lf.getSnapshot();

  // or version 1.1.13
  // lf.extension.snapshot.getSnapshot()
});

```

It is worth mentioning that the images captured and downloaded through this plug-in will not be affected by offset or scaling.

## Customize CSS

When custom elements need to add additional CSS styles when exporting images, you can do it as follows:

In order to keep the images generated by the flowchart consistent with the effects on the canvas, the `snapshot` plugin will load all `css` rules of the current page into the exported images by default, but this may cause errors due to cross-domain CSS files, refer to issue575. You can modify useGlobalRules to prohibit loading all CSS rules, and then use the `customCssRules` property to customize and add CSS styles.

```tsx | pure

// CSS style is enabled by default
lf.extension.snapshot.useGlobalRules = true
// Will not overwrite css styles, will be superimposed, customCssRules has a high priority
lf.extension.snapshot.customCssRules = `
  .uml-wrapper {
    line-height: 1.2;
    text-align: center;
    color: blue;
  }
`
  
```

## API

### lf.getSnapshot(...)

Export the image.

```ts

getSnapshot(fileName?: string, toImageOptions?: ToImageOptions) : Promise<void>

```

`fileName` is the file name. If it is not filled in, the default value is `logic-flow.${current timestamp}`. `ToImageOptions` is described as follows:

| Property Name | Type | Default Value | Required | Description |
| --------- | -------- | -------------------------- | -------- | ----------------------------------------------------------------- |
| fileType | string | png | | The format of the exported image. The optional values ​​are: `png`, `webp`, `jpeg`, `svg`. The default value is `png` |
| width | number | - | | The width of the exported image. Usually, it does not need to be set. Setting it may stretch the image. |
| height | numebr | - | | The height of the exported image. Usually, it does not need to be set. Setting it may stretch the image. |
| backgroundColor | string | - | | The background color of the exported image. The default value is transparent |
| quality | number | - | | The quality of the exported image. When the image format is specified as `jpeg` or `webp`, the image quality can be selected from the range of 0 to 1. If it exceeds the value range, the default value of 0.92 will be used. This parameter will be ignored when exporting to other formats. |
| padding | number | 40 | | The inner margin of the exported image, that is, the distance between the border of the element content area and the border of the image, in pixels, the default is 40 |
| partial | boolean | - | | Whether to enable partial rendering when exporting images, `false`: all elements on the canvas will be exported, `true`: only visible elements in the screen area will be exported |

Note:
- `svg` currently does not support `width`, `height`, `backgroundColor`, `padding` attributes.
- After customizing the width and height, the graphics may be stretched, and `padding` will also be stretched, resulting in inaccuracy.
- The `toImageOptions` option is supported in `2.0.0` version.

### lf.getSnapshotBlob(...)

In addition to supporting image type export, `snapshot` also supports downloading <a href="https://developer.mozilla.org/en-US/docs/Web/API/Blob" target="_blank"> Blob file objects </a> and <a href="https://developer.mozilla.org/en-US/docs/Glossary/Base64" target="_blank"> Base64 text encoding </a>

Get a Blob object.

```ts

async getSnapshotBlob(backgroundColor?: string, fileType?: string) : Promise<SnapshotResponse>

// example
const { data : blob } = await lf.getSnapshotBlob()
console.log(blob)

```

`backgroundColor`: background, transparent by default if not filled.

`fileType`: file type, png by default if not filled.

`SnapshotResponse`: return object.

```tsx | pure

export type SnapshotResponse = {
  data: Blob | string // Blob object or Base64 encoded text
  width: number // Image width
  height: number // Image height
}

```

### lf.getSnapshotBase64(...)

Get the `Base64 text encoding` of the text.

```ts

async getSnapshotBase64(backgroundColor?: string, fileType?: string) : Promise<SnapshotResponse>

// example
const { data : base64 } = await lf.getSnapshotBlob()
console.log(base64)
```

## Other export types

### xml

1.0.7 New

The default data generated by LogicFlow is in json format. Some process engines may require the front end to provide data in xml format. `@logicflow/extension` provides two plugins, `lfJson2Xml` and `lfXml2Json`, for converting json and xml to each other.

```jsx | pure
import LogicFlow from "@logicflow/core";
import { lfJson2Xml, lfXml2Json } from "@logicflow/extension";

const data = {
  // ...
};

const lf = new LogicFlow({
  // ...
});

lf.render(data);

// json -> xml
const xml = lfJson2Xml(lf.getGraphData());

// xml -> json
const jsonData = lfXml2Json(xml)
```

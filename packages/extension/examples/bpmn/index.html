<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="format-detection" content="telephone=no, email=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>LOGIC FLOW</title>
  <link rel="stylesheet" href="/core/dist/style/index.css">
  <!-- <link rel="stylesheet" href="http://0.0.0.0:9099/src/style/index.css"> -->
  <link rel="stylesheet" href="/extension/src/style/index.css">
  <style>
    html,body {
      padding: 0;
      margin: 0;
    }
    body {
      background-color: #FFF;
    }
    .rules-graph {
      margin-top: 30px;
      margin-left: 30px;
      position: relative;
    }
    .custom-minimap {
      background: url(data:image/png;base64,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);
    }
    #app {
      width: 1200px;
      height: 500px;
      border: 1px solid #efefef;
    }
    .graph-io {
      position: absolute;
      left: 10px;
      bottom: 10px;
      z-index: 9999;
      background:rgba(255,255,255,0.8);
      box-shadow: 0 1px 4px rgba(0,0,0,.3);
      padding: 10px;
      display: flex;
    }
    .graph-io a {
      margin: 0 5px;
    }
    #upload-xml {
      position: relative;
      overflow: hidden;
      display: inline-block;
      cursor: pointer;
    }
    .upload {
      position: absolute;
      z-index: 99;
      left: 0;
      top: 0;
      opacity: 0;
      cursor: pointer;
    }
    .upload::-webkit-file-upload-button{
      cursor: pointer;
    }
    .custom-tips {
      display: none;
      position: absolute;
      width: 16px;
      height: 16px;
      cursor: pointer;
      background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAgCAYAAACcuBHKAAACXUlEQVRYR+1XO2wTQRB9a1suKAAJGqhSQUGB+Ei0pEKyb062gdR0qfiK1MQtEiSCKhWpCdjSzdqiI5RIgIgEBTRUQAMSpKCwfB401tkcju+yjm2l8XWnezPzbufN7luDER8iWhORi8aYE4OhIvLZGLPJzIujpDWjgIloBcAth5hVZr7tgOtCnEn4vn9VRJ5GibcBvBtS5CyAg93ExiwEQbDhQsSZhOd5y8aYe5pUROattZuDBTzP0za9jDBVa+2yMwkt4AT+R6KahI8RTcTEY5WoIaIPAE65kJgS5qOSeALg2pQKuKRd72pCe9lDx3sKYEffXbImYFQvfU31MKqt/4S5V2G5EEsT9tgklPiwSRkyOYnTNRYJInoE4DqAx8x8I21Fxl4Jz/MKxpglZp6PFyIi3RNUT7pVd7+VSqW5MAy196+Yeb2HH5sEEX0BMCciG9bahV7iYSSSik2ChESF+3+s7zMSs3bEp2CmifheMZuO/ZqOrwCO77cwSwBuioj6xr7H2OXs2GLm1YmdHUmnIxE9BKDWfoWZ70z1FN0l+WT9RLFYPJfJZN5Elv2Btfaui2tywfi+f19ElhTb6XTONxqNt31LOZiAiH7rBcYY8z4IgjMuBVwwvu+/EJFLALaZ+VA8Zsflh4ieAbgcrUY1n8+v1Wq17y6FhmEqlcqxVqu12DO5AJ4z85VUEuVy+Ui73f4RA/0B8AmArtCoj/7xSQAHeoG5XO5ovV7/mUpCPxYKhQvZbLYW7Q2jFk7CfwvDsNJsNl8PAlLvopElOx35yMN7YPNLNzgR2Uq7l/4FHSW5gJV0bmAAAAAASUVORK5CYII=') center center no-repeat;
      background-size: cover;
    }
  </style>
</head>
<body>
  <div>兼容BPMN官方DEMO，此处仅实现了bpmn中的一部分节点</div>
  <div>此页面绘制的图可以在BPMN官方DEMO中正常使用</div>
  <div>
    点击左下角下载xml，将文件上传到 <a href="https://demo.bpmn.io/" target="_blank">https://demo.bpmn.io/</a>即可使用。
  </div>
  <div>
    <button id="js_get_path">获取路径</button>
    <button id="js_show_path">原始路径</button>
    <button id="js_auto_layout">自动布局</button>
    <button id="js_get_data">获取数据</button>
  </div>
  <div class="rules-graph">
    <div id="app"></div>
    <!-- <div class="pattern">
      <div class="pattern-selection" id="selection-node-pattern"></div>
      <div>选区</div>
      <div class="pattern-start" id="start-node-pattern"></div>
      <div>开始</div>
      <div class="pattern-user" id="user-node-pattern"></div>
      <div>用户任务</div>
      <div class="pattern-user" id="system-node-pattern"></div>
      <div>系统任务</div>
      <div class="pattern-condition" id="condition-node-pattern"></div>
      <div>条件判断</div>
      <div class="pattern-end" id="end-node-pattern"></div>
      <div>结束</div>
    </div> -->
    <div class="graph-io">
      <a href="javascript:;" id="download"><img src="./img/download.png" /></a>
      <a href="javascript:;" id="download-img"><img src="./img/img.png" /></a>
      <a href="javascript:;" id="upload-xml">
        <input type="file" class="upload" id="upload" /><img src="./img/upload.png" />
      </a>
    </div>
  </div>
  <!-- <script src="/core/dist/logic-flow.js"></script> -->
  <script src="http://localhost:9093/logic-flow.js"></script>
  <script src="/BpmnElement.js"></script>
  <script src="/BpmnAdapter.js"></script>
  <script src="/Control.js"></script>
  <script src="/SelectionSelect.js"></script>
  <script src="/Snapshot.js"></script>
  <script src="/MiniMap.js"></script>
  <script src="/Menu.js"></script>
  <script src="/FlowPath.js"></script>
  <script src="/AutoLayout.js"></script>
  <script src="/Group.js"></script>
  <script src="/DndPanel.js"></script>
  <!-- <script src="./tips.js"></script> -->
  <script>
    LogicFlow.use(BpmnElement);
    LogicFlow.use(MiniMap);
    MiniMap.init({
      disabledPlugins: [Menu.name]
    })
    LogicFlow.use(FlowPath);
    LogicFlow.use(AutoLayout);
    LogicFlow.use(DndPanel);
    LogicFlow.use(Menu);
    // console.log(Group);
    LogicFlow.use(Group);
    Control.addItem({
      iconClass: 'custom-minimap',
      title: '',
      text: '导航',
      onMouseEnter: (lf, ev) => {
        console.log(MiniMap, ev);
        const position = lf.getPointByClient(ev.x, ev.y);
        console.log(position);
        MiniMap.show(position.domOverlayPosition.x - 120, position.domOverlayPosition.y + 35);
      },
      onClick: (lf, ev) => {
        // console.log(MiniMap, ev);
        const position = lf.getPointByClient(ev.x, ev.y);
        // console.log(position);
        MiniMap.show(position.domOverlayPosition.x - 120, position.domOverlayPosition.y + 35);
      },
    });
    LogicFlow.use(Control);
    LogicFlow.use(BpmnAdapter);
    LogicFlow.use(Snapshot);
    LogicFlow.use(SelectionSelect);
  </script>
  <script src="./xml2json.js"></script>
  <script src="./json2xml.js"></script>
  <script src="./index.js"></script>
  
</body>
</html>
